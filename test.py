from connect_to_gdax import *
from our_bot import *
from bot_log import *
import json

ob = OurBot(api_key, api_secret, passphrase)

print(ob.get_fills(product_id = "LTC-USD"))

def parse_get_product_trades(api_response):
    last_trades = 0
    trade_data = api_response
    for trade in trade_data:
        last_trades += float(trade["price"])
    avg_trade_price = last_trades / len(trade_data)
    return avg_trade_price

print ob.get_fills()
[[{u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'BTC-USD', u'order_id': u'96a5e728-89b1-497d-97b2-4637db152b91', u'created_at': u'2017-12-13T23:16:17.944Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'16859.00000000', u'trade_id': 28155092, u'settled': True, u'liquidity': u'M', u'size': u'0.01742780'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'ETH-USD', u'order_id': u'db78467b-bd6f-40fc-98ab-d7057dc9c758', u'created_at': u'2017-12-14T14:22:07.104Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'buy', u'price': u'690.00000000', u'trade_id': 21213208, u'settled': True, u'liquidity': u'M', u'size': u'0.01000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'ETH-USD', u'order_id': u'ef97ab1b-1bd7-45c3-a1c6-925c3547e5d6', u'created_at': u'2017-12-13T22:49:00.477Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'714.00000000', u'trade_id': 21030590, u'settled': True, u'liquidity': u'M', u'size': u'0.56770179'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'ETH-USD', u'order_id': u'6e88cd6c-9ca4-4faa-9d75-ea5ded1e228f', u'created_at': u'2017-12-13T20:53:03.006Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'690.00000000', u'trade_id': 21015859, u'settled': True, u'liquidity': u'M', u'size': u'0.10000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'ETH-USD', u'order_id': u'492a1799-e831-42ad-a30a-48bff7fbf9bd', u'created_at': u'2017-12-13T20:42:38.685Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'681.00000000', u'trade_id': 21014550, u'settled': True, u'liquidity': u'M', u'size': u'0.01000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'LTC-USD', u'order_id': u'8f1de547-031a-40d3-8ef5-470b854f1fff', u'created_at': u'2017-12-15T15:21:21.583Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'311.02000000', u'trade_id': 18057076, u'settled': True, u'liquidity': u'M', u'size': u'5.00000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'LTC-USD', u'order_id': u'67efda48-3121-4ac5-bc86-83055868ba10', u'created_at': u'2017-12-14T14:51:52.582Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'buy', u'price': u'280.00000000', u'trade_id': 17677234, u'settled': True, u'liquidity': u'M', u'size': u'4.00000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'LTC-USD', u'order_id': u'509e3ca3-aadb-4b66-b9c3-1f4cadd0e8fa', u'created_at': u'2017-12-13T22:26:15.108Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'317.77000000', u'trade_id': 17438969, u'settled': True, u'liquidity': u'M', u'size': u'2.03038619'}]]





api_response = [{u'trade_id': 18653784, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:46.618Z'}, {u'trade_id': 18653774, u'size': u'0.01000000', u'side': u'buy', u'price': u'327.01000000', u'time': u'2017-12-17T07:16:46.582Z'}, {u'trade_id': 18653773, u'size': u'0.00457315', u'side': u'sell', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:46.472Z'}, {u'trade_id': 18653772, u'size': u'0.00457315', u'side': u'sell', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:46.397Z'}, {u'trade_id': 18653771, u'size': u'0.00457315', u'side': u'sell', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:46.204Z'}, {u'trade_id': 18653770, u'size': u'0.00457315', u'side': u'sell', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:46.08Z'}, {u'trade_id': 18653735, u'size': u'0.01000000', u'side': u'buy', u'price': u'327.01000000', u'time': u'2017-12-17T07:16:45.877Z'}, {u'trade_id': 18653734, u'size': u'0.01000000', u'side': u'buy', u'price': u'327.01000000', u'time': u'2017-12-17T07:16:45.877Z'}, {u'trade_id': 18653733, u'size': u'12.97681343', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:45.877Z'}, {u'trade_id': 18653732, u'size': u'0.04468000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:45.877Z'}, {u'trade_id': 18653731, u'size': u'10.00000000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:45.877Z'}, {u'trade_id': 18653730, u'size': u'0.88706565', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:45.877Z'}, {u'trade_id': 18653729, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:45.336Z'}, {u'trade_id': 18653728, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:45.003Z'}, {u'trade_id': 18653727, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:44.928Z'}, {u'trade_id': 18653726, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:44.895Z'}, {u'trade_id': 18653725, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:44.785Z'}, {u'trade_id': 18653724, u'size': u'0.01376062', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:44.55Z'}, {u'trade_id': 18653723, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:44.344Z'}, {u'trade_id': 18653722, u'size': u'20.85070000', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:44.248Z'}, {u'trade_id': 18653721, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:44.146Z'}, {u'trade_id': 18653720, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:43.938Z'}, {u'trade_id': 18653719, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:43.879Z'}, {u'trade_id': 18653718, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:43.796Z'}, {u'trade_id': 18653717, u'size': u'0.08281726', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:43.519Z'}, {u'trade_id': 18653716, u'size': u'50.00000000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:43.485Z'}, {u'trade_id': 18653715, u'size': u'0.05061055', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:42.322Z'}, {u'trade_id': 18653714, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:42.277Z'}, {u'trade_id': 18653713, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:42.271Z'}, {u'trade_id': 18653712, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:42.223Z'}, {u'trade_id': 18653711, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:42.137Z'}, {u'trade_id': 18653710, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:41.928Z'}, {u'trade_id': 18653709, u'size': u'0.01371904', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:41.782Z'}, {u'trade_id': 18653708, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:41.588Z'}, {u'trade_id': 18653707, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:41.269Z'}, {u'trade_id': 18653706, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:41.03Z'}, {u'trade_id': 18653705, u'size': u'9.74000000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:40.728Z'}, {u'trade_id': 18653704, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.852Z'}, {u'trade_id': 18653703, u'size': u'0.01376062', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.764Z'}, {u'trade_id': 18653702, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.71Z'}, {u'trade_id': 18653701, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.596Z'}, {u'trade_id': 18653700, u'size': u'0.02359705', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.471Z'}, {u'trade_id': 18653699, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.31Z'}, {u'trade_id': 18653698, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.259Z'}, {u'trade_id': 18653697, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.217Z'}, {u'trade_id': 18653696, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.151Z'}, {u'trade_id': 18653695, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:39.044Z'}, {u'trade_id': 18653694, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.983Z'}, {u'trade_id': 18653693, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.91Z'}, {u'trade_id': 18653692, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.867Z'}, {u'trade_id': 18653691, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.745Z'}, {u'trade_id': 18653690, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.596Z'}, {u'trade_id': 18653689, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.214Z'}, {u'trade_id': 18653688, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.133Z'}, {u'trade_id': 18653687, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:38.047Z'}, {u'trade_id': 18653686, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:37.944Z'}, {u'trade_id': 18653685, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:37.833Z'}, {u'trade_id': 18653684, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:37.762Z'}, {u'trade_id': 18653683, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:37.7Z'}, {u'trade_id': 18653682, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:37.568Z'}, {u'trade_id': 18653681, u'size': u'0.13342781', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:37.313Z'}, {u'trade_id': 18653680, u'size': u'0.90000000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:37.281Z'}, {u'trade_id': 18653679, u'size': u'6.31667350', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:36.786Z'}, {u'trade_id': 18653678, u'size': u'0.04600959', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:36.461Z'}, {u'trade_id': 18653677, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:36.276Z'}, {u'trade_id': 18653676, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:36.238Z'}, {u'trade_id': 18653675, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:36.034Z'}, {u'trade_id': 18653674, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:35.918Z'}, {u'trade_id': 18653673, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:35.798Z'}, {u'trade_id': 18653672, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:35.689Z'}, {u'trade_id': 18653671, u'size': u'0.01371904', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:35.563Z'}, {u'trade_id': 18653670, u'size': u'0.00457301', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:35.444Z'}, {u'trade_id': 18653669, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:32.664Z'}, {u'trade_id': 18653668, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:32.569Z'}, {u'trade_id': 18653667, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:32.445Z'}, {u'trade_id': 18653666, u'size': u'1.00000000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:32.415Z'}, {u'trade_id': 18653665, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:32.269Z'}, {u'trade_id': 18653664, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.764Z'}, {u'trade_id': 18653663, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.677Z'}, {u'trade_id': 18653662, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.633Z'}, {u'trade_id': 18653661, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.596Z'}, {u'trade_id': 18653660, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.406Z'}, {u'trade_id': 18653659, u'size': u'26.96477617', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.369Z'}, {u'trade_id': 18653658, u'size': u'10.00000000', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.369Z'}, {u'trade_id': 18653657, u'size': u'63.03522383', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.369Z'}, {u'trade_id': 18653656, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:31.315Z'}, {u'trade_id': 18653655, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.841Z'}, {u'trade_id': 18653654, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.79Z'}, {u'trade_id': 18653653, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.747Z'}, {u'trade_id': 18653652, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.642Z'}, {u'trade_id': 18653651, u'size': u'41.60300000', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:30.608Z'}, {u'trade_id': 18653650, u'size': u'0.01376062', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.563Z'}, {u'trade_id': 18653649, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.49Z'}, {u'trade_id': 18653648, u'size': u'0.11962493', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:30.23Z'}, {u'trade_id': 18653647, u'size': u'17.71372044', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.155Z'}, {u'trade_id': 18653646, u'size': u'0.16891775', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.155Z'}, {u'trade_id': 18653645, u'size': u'0.01735878', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:30.155Z'}, {u'trade_id': 18653644, u'size': u'0.00458687', u'side': u'buy', u'price': u'327.02000000', u'time': u'2017-12-17T07:16:28.424Z'}, {u'trade_id': 18653643, u'size': u'29.81669545', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:28.231Z'}, {u'trade_id': 18653642, u'size': u'24.00000000', u'side': u'sell', u'price': u'327.03000000', u'time': u'2017-12-17T07:16:28.231Z'}]


parse_get_product_trades(api_response)
print
print
    when_strategy = "big_swings",
    how_much_strategy = "risky_business",
    buy_or_sell = "SELL",
    amt_USD = 100.01,
    amt_crypto = 0.004,
    product_name = "LTC-USD"



def parse_get_fills(api_response):
    last_order = api_response[0][0]
    return last_order["product_id"], last_order["price"]

api_response = [[{u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'LTC-USD', u'order_id': u'8f1de547-031a-40d3-8ef5-470b854f1fff', u'created_at': u'2017-12-15T15:21:21.583Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'311.02000000', u'trade_id': 18057076, u'settled': True, u'liquidity': u'M', u'size': u'5.00000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'LTC-USD', u'order_id': u'67efda48-3121-4ac5-bc86-83055868ba10', u'created_at': u'2017-12-14T14:51:52.582Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'buy', u'price': u'280.00000000', u'trade_id': 17677234, u'settled': True, u'liquidity': u'M', u'size': u'4.00000000'}, {u'fee': u'0.0000000000000000', u'user_id': u'5a21e2ec8c2f93020d945e51', u'product_id': u'LTC-USD', u'order_id': u'509e3ca3-aadb-4b66-b9c3-1f4cadd0e8fa', u'created_at': u'2017-12-13T22:26:15.108Z', u'profile_id': u'579a3628-7428-4389-a908-904f425109ad', u'side': u'sell', u'price': u'317.77000000', u'trade_id': 17438969, u'settled': True, u'liquidity': u'M', u'size': u'2.03038619'}]]

parse_get_fills(api_response)
